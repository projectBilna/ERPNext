if(!window.erpnext)window.erpnext={};frappe.send_message=function(opts,btn){return frappe.call({type:"POST",method:"erpnext.templates.utils.send_message",btn:btn,args:opts,callback:opts.callback});};erpnext.subscribe_to_newsletter=function(opts,btn){return frappe.call({type:"POST",method:"erpnext.crm.doctype.newsletter.newsletter.subscribe",btn:btn,args:{"email":opts.email},callback:opts.callback});}
erpnext.send_message=frappe.send_message;;frappe.provide("shopping_cart");$(function(){if(full_name){$('.navbar li[data-label="User"] a').html('<i class="icon-fixed-width icon-user"></i> '+full_name);}
shopping_cart.set_cart_count();});$.extend(shopping_cart,{update_cart:function(opts){if(!full_name){if(localStorage){localStorage.setItem("last_visited",window.location.pathname);localStorage.setItem("pending_add_to_cart",opts.item_code);}
window.location.href="/login";}else{return frappe.call({type:"POST",method:"erpnext.shopping_cart.cart.update_cart",args:{item_code:opts.item_code,qty:opts.qty,with_doc:opts.with_doc||0},btn:opts.btn,callback:function(r){if(opts.callback)
opts.callback(r);shopping_cart.set_cart_count();}});}},set_cart_count:function(){var cart_count=getCookie("cart_count");var $cart=$('.dropdown [data-label="Cart"]');var $badge=$cart.find(".badge");if(cart_count){if($badge.length===0){var $badge=$('<span class="badge pull-right"></span>').prependTo($cart.find("a").addClass("badge-hover"));}
$badge.html(cart_count);}else{$badge.remove();}}});;